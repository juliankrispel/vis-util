!function(){define(["_"],function(t){var e={degToRad:function(t){return Math.PI*t/180},radToDeg:function(t){return t/Math.PI*180},getArcVectors:function(t,e){return{x1:Math.cos(this.degToRad(t)),y1:Math.sin(this.degToRad(t)),x2:Math.cos(this.degToRad(e)),y2:Math.sin(this.degToRad(e))}},createPieChartVectors:function(e,r,a,n){var i=this;if(!t.every(e,t.isNumber)&&!t.every(e,function(t){return t>0}))throw new Error("createPieChartPathData only accepts an array of positive numbers as the data argument");if(r>360)throw new Error("totalDegrees argument can't be more than 360");void 0===a&&(a=0),void 0===r&&(r=360),void 0===n&&(n=!0);var o=t.reduce(e,function(t,e){return t+e}),u=this.createScale(0,o,0,r),s=a,c=t(e).map(function(t){var e=u(t),r=i.getArcVectors(s,s+e);return s+=e,r.largeArc=e>180?1:0,r}).value();return c},createOrdinalScale:function(e){var r=t.clone(e);if(!t.isArray(e))throw new Error("createOrdinalScale only takes array as argument");return function(a){if(t.isNumber(a)&&e.length>a)return e[a];var n=r.shift();return r.push(n),n}},createScale:function(e,r,a,n){if(!t.every([e,r,a,n],function(e){return t.isNumber(e)||t.isDate(e)}))throw new Error("scale only accepts numbers or dates");return e=e.valueOf(),r=r.valueOf(),a=a.valueOf(),n=n.valueOf(),n>a?function(t){return(t-e)/(r-e)*(n-a)+a}:a>n?function(t){return(t-e)/(r-e)*(n-a)+a}:void 0},nearest:function(t,e){return t/=e,t=Math.round(t)*e},normalizeData:function(e){return t.map(e,function(e,r){return!t.isObject(e)&&t.isNumber(e)?{x:r,y:e}:e})},isDataPoint:function(t){return void 0!==t.x&&void 0!==t.y},assertGraphData:function(e){if(!t.isArray(e))throw new Error("data argument has to be array");if(t.every(e,t.isObject)&&!t.every(e,this.isDataPoint))throw new Error("All objects in data argument need to have x and y attributes");if(!t.every(e,t.isObject)&&!t.every(e,t.isNumber))throw new Error("If data array isn't an array of objects it must be an array of numbers")},assertDataArray:function(e){if(!t.isArray(e))throw new Error("tick data has to be array");if(!t.every(e,t.isNumber)&&!t.every(e,t.isDate))throw new Error("tick data has to be an array of dates, numbers or strings")},convertDataToSvgPaths:function(e,r,a,n){var i=t(e).pluck("data").flatten().pluck("x").value(),o=t(e).pluck("data").flatten().pluck("y").value(),u=t.max(o),s=t.min(o),c=t.max(i),h=t.min(i),l=this.createOrdinalScale(n),f=this.createScale(h,c,0,r),v=this.createScale(s,u,a,0),m=this;return t.map(e,function(t){return{label:t.label,path:m.convertDataToSvgPath(t.data,r,a,f,v),color:l()}})},convertDataToSvgPath:function(e,r,a,n,i){this.assertGraphData(e),e=this.normalizeData(e);var o=(e.length,t(e).map(function(t){return{x:n(t.x),y:i(t.y)}}));return"M "+t(o).map(function(t){return""+t.x+" "+t.y}).join(" L ")},getZeroDecimalCount:function(t){var e=""+t;return e.match(/0\.(?:0+)?/)[0].length-2},roundUpToStep:function(t,e){var r;return r=parseFloat(1>e?(Math.ceil(t/e)*e).toFixed(this.getZeroDecimalCount(e)+1):Math.ceil(t/e)*e)},timeSteps:[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],numberSteps:[1,2,5,10],roundTickInterval:function(e,r){var a,n=""+e;if("date"===r)return t(this.timeSteps).filter(function(t){return t>e}).min(function(t){var r=Math.abs(e-t);return r}).value();if(.1>e){var i=this.getZeroDecimalCount(e),o=n.substr(i+2);a=parseFloat(o.substr(0,1)+"."+o.substr(1));var u=100*i;return t(this.numberSteps).min(function(t){return Math.abs(t-a)}).value()/u}var s=n.match(/\d+/)[0].length,c=Math.pow(10,s-1);return a=e/c,t(this.numberSteps).map().min(function(t){return Math.abs(t-a)}).value()*c},createTickValues:function(e,r){this.assertDataArray(e);var a=t.max(e),n=t.min(e),i="number";t.isDate(a)&&(i="date");for(var o=this.roundTickInterval((a-n)/r,i),u=this.roundUpToStep(n,o),s=[u];a>u+o;)u+=o,s.push(u);return"date"===i&&(s=t.map(s,this.toDate)),s},toDate:function(t){return new Date(t)},createTickObjects:function(e,r,a,n,i){if(!t.isArray(e))throw new Error("data needs to be array");if(!t.isNumber(r)||isNaN(r)||0>r)throw new Error("size needs to be an absolute number");n=n||10,a=a||10;var o,u=this,s=t.max(e),c=t.min(e);o=i?this.createScale(c,s,r,0):this.createScale(c,s,0,r);var h=Math.floor(r/n);a>h&&(a=h);var l=this.createTickValues(e,a),f=t.map(l,function(t){var e=u.formatChartLabel(t);return{label:e,value:t,position:o(t)}});return f[0].value!==c&&f.unshift({label:"",value:c,position:o(c)}),f[f.length-1].value!==s&&f.push({label:"",value:s,position:o(s)}),f},formatChartLabel:function(e){return t.isNumber(e)?e:t.isDate(e)?e.toDateString():void 0}};return e})}();